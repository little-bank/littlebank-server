<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>관리자 로그인</title>
    <style>
        body { font-family: Pretendard, sans-serif; padding: 40px; max-width: 400px; margin: auto; }
        input { display: block; margin-bottom: 12px; width: 100%; padding: 10px; font-size: 16px; }
        button { padding: 12px 20px; font-size: 16px; }
        label { font-weight: bold; display: block; margin-top: 10px; }
    </style>
</head>
<body>
<h1>관리자 로그인</h1>
<label for="email">이메일</label>
<input type="email" id="email" placeholder="example@gmail.com" required />

<label for="password">비밀번호</label>
<input type="password" id="password" placeholder="비밀번호 입력" required />

<label for="fcm">FCM 토큰</label>
<input type="text" id="fcm" placeholder="FCM 토큰 (선택)" />

<button onclick="login()">로그인</button>

<script>
    async function login() {
        const email = document.getElementById('email').value.trim();
        const password = document.getElementById('password').value.trim();
        const fcmToken = document.getElementById('fcm').value.trim() || 'test-fcm-token';

        if (!email || !password || !fcmToken) {
            alert("모든 입력값을 입력해주세요.");
            return;
        }

        try {
            const response = await fetch('/api-admin/auth/public/login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email, password, fcmToken })
            });

            if (!response.ok) {
                alert("로그인 실패: 이메일 또는 비밀번호가 올바르지 않습니다.");
                return;
            }

            const result = await response.json(); // { accessToken: "Bearer ..." }

            localStorage.setItem("adminToken", result.accessToken);
            location.href = "/admin/dashboard"; // 어드민 메인페이지로 리디렉션

        } catch (err) {
            console.error(err);
            alert("로그인 중 오류가 발생했습니다.");
        }
    }
</script>
</body>
</html>