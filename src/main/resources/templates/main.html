<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>메인</title>
  <link rel="stylesheet" href="/css/main.css">
</head>
<body>
<div class="container">
  <h1>메인 화면</h1>
  <p>서비스에 오신 것을 환영합니다.</p>

  <a href="/view/mypage">마이페이지</a>

  <!-- 로그아웃 버튼만 남김 -->
  <button onclick="logout()">로그아웃</button>
</div>

<script>
  async function logout() {
    const confirmed = confirm("정말 로그아웃하시겠습니까?");
    if (!confirmed) return;

    try {
      // accessToken 헤더 + 쿠키 전송
      const res = await fetch("/api-user/auth/logout", {
        method: "POST",
        headers: {
          "Authorization": `Bearer ${localStorage.getItem("accessToken")}`
        },
        credentials: "include"  // 쿠키 포함 필수
      });

      if (res.status === 204) {
        // accessToken 삭제
        localStorage.removeItem("accessToken");

        // 로그인 페이지로 이동
        window.location.href = "/view/public/login";
      } else {
        alert("로그아웃 실패");
      }
    } catch (err) {
      alert("에러 발생: " + err.message);
    }
  }
</script>
</body>
</html>